header:
  version: 14

repos:
  uav-qualgo:
    url: git@github.com:uneycom/uav-yocto-build.git
    path: repos/uav-qualgo
    branch: uav-720_dev-pxe-boot
    layers:
      poky/meta-edk2:
      poky/meta-skytrack-kernel:
      poky/meta-skytrack-secureboot:
      poky/meta-edk2-nvidia:
      poky/meta-skytrack-dev:

  meta-rtlwifi:
    path: repos/meta-rtlwifi
    url: https://github.com/EmbeddedAndroid/meta-rtlwifi
    branch: master

local_conf_header:
  secure-boot: |
    SECUREBOOT_KEYS_DIR ?= "${TOPDIR}/../uefi_keys"
    SECUREBOOT_PK_KEY   = "${SECUREBOOT_KEYS_DIR}/PK.key"
    SECUREBOOT_PK_CERT  = "${SECUREBOOT_KEYS_DIR}/PK.crt"
    SECUREBOOT_KEK_KEY  = "${SECUREBOOT_KEYS_DIR}/KEK.key"
    SECUREBOOT_KEK_CERT = "${SECUREBOOT_KEYS_DIR}/KEK.crt"
    SECUREBOOT_DB_ESL   = "${SECUREBOOT_KEYS_DIR}/db.esl"
    SECUREBOOT_DB_AUTH  = "${SECUREBOOT_KEYS_DIR}/db.auth"

    UEFI1_DB_KEY   = "${SECUREBOOT_KEYS_DIR}/sign-uefi1.key"
    UEFI1_DB_CERT  = "${SECUREBOOT_KEYS_DIR}/sign-uefi1.crt"

    UEFI2_DB_KEY   = "${SECUREBOOT_KEYS_DIR}/sign-uefi2.key"
    UEFI2_DB_CERT  = "${SECUREBOOT_KEYS_DIR}/sign-uefi2.crt"

    KERNEL_DB_KEY  = "${SECUREBOOT_KEYS_DIR}/sign-kernel.key"
    KERNEL_DB_CERT = "${SECUREBOOT_KEYS_DIR}/sign-kernel.crt"

    IMAGE_INSTALL:append = " \
      secureboot-keys \
      util-linux \
      apt \
    "

    IMAGE_INSTALL:append = " cuda-toolkit cuda-samples"

    EXTRA_IMAGE_FEATURES ?= "debug-tweaks"

    IMAGE_INSTALL:remove = " dropbear"

    IMAGE_INSTALL:append = " uefi1-prebuilt"
